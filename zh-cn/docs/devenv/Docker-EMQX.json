{
  "filename": "Docker-EMQX.md",
  "__html": "<p><a href=\"https://hub.docker.com/_/emqx\">EMQX</a></p>\n<pre><code class=\"language-shell\">docker run -d \\\n  --publish 18083:18083 \\\n  --publish 1883:1883 \\\n  --env HOCON_ENV_OVERRIDE_PREFIX=DEV_ \\\n  --env DEV_MQTT__ZONE__SHARED_SUBSCRIPTION=true \\\n  --env DEV_MQTT__ZONE__EXTERNAL__SHARED_SUBSCRIPTION=true \\\n  --env DEV_MQTT__BROKER__SHARED_SUBSCRIPTION_STRATEGY=round_robin \\\n  --env DEV_MQTT__BROKER__SHARED_DISPATCH_ACK_ENABLE=true \\\n  --restart=no \\\n  --name emqx \\\n  emqx:4.3\n\ndocker exec -it -u root emqx /bin/bash\nvim /etc/emqx/emqx.conf\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\">修改这两个就行，默认配置文件里面就有，修改为utf8就行。</span>\ndefault-character-set=utf8\ncharacter-set-server=utf8\n<span class=\"hljs-meta\">#</span><span class=\"bash\">这个不是必须的，设置character-set-server会自动设置这个</span>\n<span class=\"hljs-meta\">#</span><span class=\"bash\">collation-server=utf8_general_ci</span>\n\n</code></pre>\n<ul>\n<li><a href=\"http://localhost:18083\">Dashboard</a>\nadmin/public</li>\n</ul>\n<h2 id=\"%E5%85%B1%E4%BA%AB%E8%AE%A2%E9%98%85\">共享订阅 <a class=\"header-anchor\" href=\"#%E5%85%B1%E4%BA%AB%E8%AE%A2%E9%98%85\">#</a></h2>\n<p>关于<a href=\"https://www.emqx.io/docs/en/v5.0/advanced/shared-subscriptions.html#shared-subscriptions-in-group\">共享订阅</a></p>\n<ol>\n<li>开启共享订阅</li>\n</ol>\n<pre><code class=\"language-conf\"># 开启共享订阅\nzone.shared_subscription = true\nzone.external.shared_subscription = true\n\n# 负载均衡策略 random round_robin sticky hash\nbroker.shared_subscription_strategy = round_robin\n\n# 适用于 QoS1 QoS2 消息，启用后，当客户端离线时，将消息派发给订阅组内其他客户端\nbroker.shared_dispatch_ack_enabled = true\n</code></pre>\n<ol start=\"2\">\n<li>共享订阅的负载均衡策略</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>均衡策略</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>random</td>\n<td>在所有订阅者中随机选择</td>\n</tr>\n<tr>\n<td>round_robin</td>\n<td>按照订阅顺序</td>\n</tr>\n<tr>\n<td>sticky</td>\n<td>一直发往上次选取的订阅者</td>\n</tr>\n<tr>\n<td>hash</td>\n<td>按照发布者 ClientID 的哈希值</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"3\">\n<li>关于Topic路径</li>\n</ol>\n<pre><code>$share/&lt;group-name&gt;/&lt;topic-name&gt;(/&lt;topic-sub-name&gt;)*\n</code></pre>\n<ul>\n<li>$share : 共享订阅的标识</li>\n<li>group-name : 共享订阅的组别名称 group-name</li>\n<li>topic-name : 实际的topic名称</li>\n<li>topic-sub-name: topic名称，可以有多段组成</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>示例</th>\n<th>前缀</th>\n<th>组别</th>\n<th>Topic 名称</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>$share/abc/t/1</td>\n<td>$share</td>\n<td>abc</td>\n<td>t/1</td>\n</tr>\n<tr>\n<td>$share/yunyi/01_混配/1#罐流量</td>\n<td>$share</td>\n<td>yunyi</td>\n<td>01_混配/1#罐流量</td>\n</tr>\n</tbody>\n</table>\n<p><strong>注意：</strong></p>\n<ul>\n<li>在订阅Topic时，使用 <code>$share/&lt;group-name&gt;/&lt;topic-name&gt;</code></li>\n<li>在发送消息时，使用 <code>&lt;topic-name&gt;</code>，不需要带<code>前缀</code>及<code>组别</code></li>\n</ul>\n",
  "link": "/zh-cn/docs/devenv/Docker-EMQX.html",
  "meta": {}
}