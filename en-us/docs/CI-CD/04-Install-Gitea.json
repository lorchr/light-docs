{
  "filename": "04-Install-Gitea.md",
  "__html": "<h1 id=\"%E5%9B%9B%E3%80%81-%E5%AE%89%E8%A3%85-gitea\">四、 安装 Gitea <a class=\"header-anchor\" href=\"#%E5%9B%9B%E3%80%81-%E5%AE%89%E8%A3%85-gitea\">#</a></h1>\n<ul>\n<li><a href=\"https://dl.gitea.io/gitea\">https://dl.gitea.io/gitea</a></li>\n<li><a href=\"https://www.kernel.org/pub/software/scm/git/git-2.37.2.tar.gz\">https://www.kernel.org/pub/software/scm/git/git-2.37.2.tar.gz</a></li>\n</ul>\n<h3 id=\"1.-%E5%AE%89%E8%A3%85\">1. 安装 <a class=\"header-anchor\" href=\"#1.-%E5%AE%89%E8%A3%85\">#</a></h3>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\"> 安装依赖</span>\nyum install -y \\\n  git \\\n  gcc-c++ \\\n  zlib-devel \\\n  perl-ExtUtils-MakeMaker \\\n  sqlite3\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 下载Git</span>\nwget https://www.kernel.org/pub/software/scm/git/git-2.37.2.tar.gz -O /usr/local/git/\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 创建安装目录</span>\nmkdir /usr/local/gitea\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 创建数据目录并新建数据库</span>\nmkdir /usr/local/gitea/data/\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 创建Sqlite数据库存储数据</span>\nsqlite3 /usr/local/gitea/data/gitea.db\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 下载Gitea</span>\nwget https://dl.gitea.io/gitea/1.8.3/gitea-1.8.3-linux-amd64 -O /usr/local/gitea/gitea\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 修改文件的执行权限</span>\nchmod +x /usr/local/gitea/gitea\n</code></pre>\n<h3 id=\"2.-%E6%B3%A8%E5%86%8C%E4%B8%BA%E6%9C%8D%E5%8A%A1\">2. 注册为服务 <a class=\"header-anchor\" href=\"#2.-%E6%B3%A8%E5%86%8C%E4%B8%BA%E6%9C%8D%E5%8A%A1\">#</a></h3>\n<p>新建一个<code>gitea.service</code>文件：</p>\n<blockquote>\n<p>vim /usr/lib/systemd/system/gitea.service</p>\n</blockquote>\n<pre><code class=\"language-shell\">[Unit]\nDescription=gitea\nAfter=network.target\n\n[Service]\nType=forking\n<span class=\"hljs-meta\">#</span><span class=\"bash\"> Gitea的执行文件</span>\nExecStart=/uar/local/gitea/gitea\nUser=root\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<h3 id=\"3.-%E5%88%9D%E5%A7%8B%E5%8C%96gitea\">3. 初始化Gitea <a class=\"header-anchor\" href=\"#3.-%E5%88%9D%E5%A7%8B%E5%8C%96gitea\">#</a></h3>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\"> 重载daemon，让新的服务文件生效：</span>\nsystemctl daemon-reload\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 启动gitea服务并设置开机自启</span>\nsystemctl start gitea &amp;&amp; systemctl enable gitea\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 修改conf文件来修改gitea配置</span>\nvim /usr/local/gitea/custom/conf/app.ini\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 备份</span>\nmv /usr/local/gitea/custom/ /usr/local/gitea/custom.bak\nmv /usr/local/gitea/data/ /usr/local/gitea/data.bak\nmv /usr/local/gitea/gitea-repositories/ /usr/local/gitea/gitea-repositories.bak\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 恢复</span>\nmv /usr/local/gitea/custom.bak/ /usr/local/gitea/custom\nmv /usr/local/gitea/data.bak/ /usr/local/gitea/data\nmv /usr/local/gitea/gitea-repositories.bak/ /usr/local/gitea/gitea-repositories\n</code></pre>\n<h3 id=\"4.-%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE\">4. 域名访问 <a class=\"header-anchor\" href=\"#4.-%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE\">#</a></h3>\n<p>如果想用域名访问，可以用Nginx反代。反代配置为：</p>\n<pre><code class=\"language-conf\"># 在配置文件里添加\nlocation /gitea/ {\n  proxy_pass http://localhost:3000/\n  proxy_redirect off;\n  proxy_set_header X-Real-IP $remote_addr;\n  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n}\n</code></pre>\n<p>访问Web页面: <a href=\"http://192.168.137.101:3000\">http://192.168.137.101:3000</a></p>\n<ul>\n<li>root/admin</li>\n</ul>\n<p>配置数据库等，并<strong>设置管理员账号密码</strong></p>\n<blockquote>\n<p>git remote set-url --add origin <a href=\"http://192.168.137.101:3000/root/pi-diginn.git\">http://192.168.137.101:3000/root/pi-diginn.git</a></p>\n</blockquote>\n",
  "link": "/en-us/docs/CI-CD/04-Install-Gitea.html",
  "meta": {}
}