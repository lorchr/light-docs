{
  "filename": "05-Install-Nexus3.md",
  "__html": "<h1 id=\"%E4%BA%94%E3%80%81-%E5%AE%89%E8%A3%85-nexus3\">五、 安装 Nexus3 <a class=\"header-anchor\" href=\"#%E4%BA%94%E3%80%81-%E5%AE%89%E8%A3%85-nexus3\">#</a></h1>\n<ul>\n<li><a href=\"https://www.sonatype.com/download-oss-sonatype\">https://www.sonatype.com/download-oss-sonatype</a></li>\n<li><a href=\"https://help.sonatype.com/repomanager3/product-information/system-requirements#SystemRequirements-Linux\">https://help.sonatype.com/repomanager3/product-information/system-requirements#SystemRequirements-Linux</a></li>\n<li><a href=\"https://help.sonatype.com/repomanager3/download/download-archives---repository-manager-3\">https://help.sonatype.com/repomanager3/download/download-archives---repository-manager-3</a></li>\n</ul>\n<h3 id=\"1.-%E5%AE%89%E8%A3%85\">1. 安装 <a class=\"header-anchor\" href=\"#1.-%E5%AE%89%E8%A3%85\">#</a></h3>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\"> 下载安装包</span>\nwget https://download.sonatype.com/nexus/3/nexus-3.2.0-01-unix.tar.gz -O /usr/local/nexus/nexus-3.2.0-01-unix.tar.gz\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 创建安装目录</span>\nmkdir /usr/local/nexus/\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 解压安装包</span>\ntar -zxvf nexus-3.2.0-01-unix.tar.gz -C /usr/local/nexus/\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 设置 NEXUS3 运行用户为 root</span>\nvim /usr/local/nexus/nexus-3.2.0-01/bin/nexus.rc\nrun_as_user=\"root\"\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 修改 NEXUS3 启动时要使用的 JDK 版本</span>\nvim /usr/local/nexus/nexus-3.2.0-01/bin/nexus\nINSTALL4J_JAVA_HOME_OVERRIDE=/usr/local/java/jdk1.8.0/\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 修改 NEXUS3 默认端口 (可选)</span>\nvim /usr/local/nexus/nexus-3.2.0-01/etc/nexus-default.properties\napplication-port=18081\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 关闭防火墙，并开启远程访问端口 18081</span>\nfirewall-cmd --zone=public --add-port=18081/tcp --permanent\nfirewall-cmd reload\nfirewall-cmd --list-all\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 创建用户并授权（跳过）</span>\nadduser nexus\npasswd nexus\nchown -R nexus /usr/local/java\nchown -R nexus /usr/local/nexus\n</code></pre>\n<h3 id=\"2.-%E6%B3%A8%E5%86%8C%E4%B8%BA%E6%9C%8D%E5%8A%A1\">2. 注册为服务 <a class=\"header-anchor\" href=\"#2.-%E6%B3%A8%E5%86%8C%E4%B8%BA%E6%9C%8D%E5%8A%A1\">#</a></h3>\n<p>新建一个<code>nexus.service</code>文件：</p>\n<blockquote>\n<p>vim /usr/lib/systemd/system/nexus.service</p>\n</blockquote>\n<pre><code class=\"language-shell\">[Unit]\nDescription=nexus\nAfter=network.target\n\n[Service]\nType=forking\n<span class=\"hljs-meta\">#</span><span class=\"bash\"> Nexus的执行文件</span>\nExecStart=/usr/local/nexus/nexus-3.2.0-01/bin/nexus start\nExecStop=/usr/local/nexus/nexus-3.2.0-01/bin/nexus stop\nUser=root\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n<h3 id=\"3.-%E5%90%AF%E5%8A%A8\">3. 启动 <a class=\"header-anchor\" href=\"#3.-%E5%90%AF%E5%8A%A8\">#</a></h3>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\"> 重启守护进程</span>\nsystemctl daemon-reload\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 启动 NEXUS3</span>\nsystemctl enable nexus &amp;&amp; systemctl start nexus\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 查看状态</span>\nsystemctl status nexus\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 新版本查看密码，老版本默认（admin/admin123）</span>\ncat /usr/local/nexus/sonatype-work/nexus3/admin.password\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 查看开机自启</span>\nsystemctl list-unit-files | grep nexus\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 关闭开机自启</span>\nsystemctl disable nexus\n</code></pre>\n<p>访问Web页面: <a href=\"http://192.168.137.102:18081/\">http://192.168.137.102:18081/</a></p>\n<ul>\n<li>admin/admin123</li>\n</ul>\n<h3 id=\"4.-%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80\">4. 仓库地址 <a class=\"header-anchor\" href=\"#4.-%E4%BB%93%E5%BA%93%E5%9C%B0%E5%9D%80\">#</a></h3>\n<table>\n<thead>\n<tr>\n<th>序号</th>\n<th>类型</th>\n<th>种类</th>\n<th>URL</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1</td>\n<td>Maven</td>\n<td>Proxy</td>\n<td><a href=\"https://repo1.maven.org/maven2/\">https://repo1.maven.org/maven2/</a></td>\n<td>中央仓库</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Maven</td>\n<td>Proxy</td>\n<td><a href=\"https://maven.aliyun.com/repository/public\">https://maven.aliyun.com/repository/public</a></td>\n<td>阿里云仓库</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Maven</td>\n<td>Hosted</td>\n<td></td>\n<td>本地仓库</td>\n</tr>\n<tr>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n</tr>\n<tr>\n<td>1</td>\n<td>NPM</td>\n<td>Proxy</td>\n<td><a href=\"https://registry.npmjs.org\">https://registry.npmjs.org</a></td>\n<td>中央仓库</td>\n</tr>\n<tr>\n<td>2</td>\n<td>NPM</td>\n<td>Proxy</td>\n<td><a href=\"https://registry.npm.tabao.org\">https://registry.npm.tabao.org</a></td>\n<td>淘宝仓库</td>\n</tr>\n<tr>\n<td>3</td>\n<td>NPM</td>\n<td>Proxy</td>\n<td><a href=\"https://registry.npmmirror.com\">https://registry.npmmirror.com</a></td>\n<td>淘宝仓库</td>\n</tr>\n<tr>\n<td>4</td>\n<td>NPM</td>\n<td>Hosted</td>\n<td></td>\n<td>本地仓库</td>\n</tr>\n<tr>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n<td>-</td>\n</tr>\n<tr>\n<td>1</td>\n<td>Docker</td>\n<td>Group</td>\n<td>http-18083</td>\n<td>组合</td>\n</tr>\n<tr>\n<td>2</td>\n<td>Docker</td>\n<td>Proxy</td>\n<td><a href=\"https://registry-1.docker.io\">https://registry-1.docker.io</a></td>\n<td>中央仓库</td>\n</tr>\n<tr>\n<td>3</td>\n<td>Docker</td>\n<td>Proxy</td>\n<td><a href=\"https://registry.cn-hangzhou.aliyuncs.com\">https://registry.cn-hangzhou.aliyuncs.com</a></td>\n<td>阿里云仓库</td>\n</tr>\n<tr>\n<td>4</td>\n<td>Docker</td>\n<td>Hosted</td>\n<td>http-18082</td>\n<td>本地仓库</td>\n</tr>\n</tbody>\n</table>\n<p><strong>Docker仓库需要配置http地址</strong>，并重新加载\nvim /etc/docker/daemon.json</p>\n<pre><code class=\"language-json\">{\n  <span class=\"hljs-attr\">\"registry-mirrors\"</span>: [<span class=\"hljs-string\">\"https://rv4ppfhe.mirror.aliyuncs.com\"</span>],\n  <span class=\"hljs-attr\">\"exec-opts\"</span>: [<span class=\"hljs-string\">\"native.cgroupdriver=systemd\"</span>],\n  <span class=\"hljs-attr\">\"insecure-registries\"</span>: [\n        <span class=\"hljs-string\">\"192.168.137.102:5000\"</span>,\n        <span class=\"hljs-string\">\"192.168.137.102:5080\"</span>,\n        <span class=\"hljs-string\">\"192.168.137.102:18082\"</span>\n  ]\n}\n</code></pre>\n<h3 id=\"5.-%E6%B5%8B%E8%AF%95\">5. 测试 <a class=\"header-anchor\" href=\"#5.-%E6%B5%8B%E8%AF%95\">#</a></h3>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\"> 重启Docker</span>\nsystemctl daemon-reload &amp;&amp; service docker restart\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 查看配置的地址是否生效</span>\ndocker info\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 登录仓库</span>\ndocker login 192.168.137.102:18082\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 拉取测试镜像</span>\ndocker pull alpine\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 重新打Tag</span>\ndocker tag alpine:latest 192.168.137.102:18082/pi-diginn/alpine:latest\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 推送到私服</span>\ndocker push 192.168.137.102:18082/pi-diginn/alpine:latest\n<span class=\"hljs-meta\">\n#</span><span class=\"bash\"> 从私服拉取镜像 走Group代理</span>\ndocker pull 192.168.137.102:18083/pi-diginn/alpine:latest\n</code></pre>\n<h3 id=\"%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BA\">使用Docker搭建 <a class=\"header-anchor\" href=\"#%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BA\">#</a></h3>\n<ul>\n<li><a href=\"https://help.sonatype.com/repomanager3/nexus-repository-administration/formats/docker-registry/docker-repository-reverse-proxy-strategies\">https://help.sonatype.com/repomanager3/nexus-repository-administration/formats/docker-registry/docker-repository-reverse-proxy-strategies</a></li>\n</ul>\n<pre><code class=\"language-shell\">docker run -d \\\n    -p 8081:8081 \\\n    -p 8082:8082 \\\n    -p 8083:8083 \\\n    -v /data/nexus-data:/nexus-data \\\n    -v /etc/hosts:/etc/hosts \\\n    -v /etc/localtime:/etc/localtime \\\n    --restart unless-stopped \\\n    --name nexus \\ \n    sonatype/nexus3\n\nhttps://blog.51cto.com/215687833/5051848\n</code></pre>\n<ul>\n<li><a href=\"https://www.cnblogs.com/hahaha111122222/p/13099635.html\">安装</a></li>\n<li><a href=\"https://hazx.hmacg.cn/server/nexus-docker-proxy.html\">安装</a></li>\n<li><a href=\"https://zhang.ge/5139.html\">安装</a></li>\n<li><a href=\"https://dylanyang.top/post/2020/06/23/nexus-3.x%E6%B8%85%E7%90%86docker%E9%95%9C%E5%83%8F/\">清理镜像</a></li>\n</ul>\n",
  "link": "/en-us/docs/CI-CD/05-Install-Nexus3.html",
  "meta": {}
}